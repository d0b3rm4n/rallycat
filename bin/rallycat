#!/usr/bin/env ruby

require 'optparse'
require 'rallycat'
require 'rally_rest_api'


options = {}
option_parser = OptionParser.new do |opts|
  opts.on('-u USER') do |user|
    options[:user] = user
  end

  opts.on('-p PASSWORD') do |password|
    options[:password] = password
  end
end

option_parser.parse!

case ARGV.shift
when "cat"
  @api = RallyRestAPI.new \
   base_url: 'https://rally1.rallydev.com/slm',
   username: options[:user],
   password: options[:password]
   # logger:   Logger.new(STDOUT)

  puts Rallycat::Cat.new(@api).story(ARGV.shift)
else
  puts 'only support for `cat` exists at the moment.'
end
